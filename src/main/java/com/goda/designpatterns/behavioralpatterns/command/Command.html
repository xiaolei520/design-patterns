<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><HTML 
xmlns="http://www.w3.org/1999/xhtml"><HEAD><META content="IE=9.0000" 
http-equiv="X-UA-Compatible">

<META content="text/html; charset=utf-8" http-equiv="Content-Type">
<TITLE>设计模式学习笔记（十七）——Command命令模式  - KiddLee - 博客园</TITLE><LINK rel="stylesheet" 
type="text/css" 
href="http://common.cnblogs.com/blog/css/common.css?id=20121228"><LINK id="MainCss" 
rel="stylesheet" type="text/css" href="http://common.cnblogs.com/Skins/En_summerGarden/style.css?id=20121228">
<LINK rel="stylesheet" type="text/css" href="http://common.cnblogs.com/blog/css/common2.css">
<LINK rel="stylesheet" type="text/css" href="http://common.cnblogs.com/css/shStyle.css">
<LINK title="RSS" rel="alternate" type="application/rss+xml" href="http://www.cnblogs.com/kid-li/rss">
<LINK title="RSD" rel="EditURI" type="application/rsd+xml" href="http://www.cnblogs.com/kid-li/rsd.xml">
<LINK rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.cnblogs.com/kid-li/wlwmanifest.xml">
<SCRIPT type="text/javascript" src="http://common.cnblogs.com/script/gpt.js"></SCRIPT>

<SCRIPT type="text/javascript" src="http://www.google-analytics.com/ga.js"></SCRIPT>

<SCRIPT type="text/javascript" src="http://common.cnblogs.com/script/jquery.js"></SCRIPT>

<SCRIPT type="text/javascript">
var currentBlogApp = 'kid-li';
</SCRIPT>

<SCRIPT type="text/javascript" src="http://common.cnblogs.com/blog/script/common.js?id=20121228"></SCRIPT>

<SCRIPT type="text/javascript" src="http://common.cnblogs.com/script/json2.js"></SCRIPT>

<SCRIPT type="text/javascript" src="http://common.cnblogs.com/script/syntaxHighlighter.js"></SCRIPT>

<SCRIPT type="text/javascript" src="http://common.cnblogs.com/script/google_ads_gpt.js"></SCRIPT>

<SCRIPT type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/osd.js"></SCRIPT>
</HEAD>
<BODY><A name="top"></A><!--done-->
<DIV id="home">
<DIV id="header">
<DIV id="blogTitle"><A id="lnkBlogLogo" 
href="http://www.cnblogs.com/kid-li/"><IMG id="blogLogo" alt="Return Home" src="/Skins/custom/images/logo.gif"></A><!--done-->
<H1><A id="Header1_HeaderTitle" class="headermaintitle" href="http://www.cnblogs.com/kid-li/">KiddLee</A></H1>
<H2>态度决定一切！我博客，留住生活中的精彩</H2></DIV><!--end: blogTitle 博客的标题和副标题 -->
<DIV id="navigator"><!--done-->
<UL id="navList">
  <LI><A id="MyLinks1_HomeLink" class="menu" 
  href="http://www.cnblogs.com/">CnBlogs</A></LI>
  <LI><A id="MyLinks1_MyHomeLink" class="menu" href="http://www.cnblogs.com/kid-li/">Home</A></LI>
  <LI><A id="MyLinks1_NewPostLink" class="menu" href="http://www.cnblogs.com/kid-li/admin/EditPosts.aspx?opt=1" 
  rel="nofollow">New Post</A></LI>
  <LI><A accessKey="9" id="MyLinks1_ContactLink" class="menu" href="http://space.cnblogs.com/msg/send/KiddLee" 
  rel="nofollow">Contact</A></LI>
  <LI><A id="MyLinks1_Admin" class="menu" href="http://www.cnblogs.com/kid-li/admin/EditPosts.aspx" 
  rel="nofollow">Admin</A></LI>
  <LI><A id="MyLinks1_Syndication" class="menu" href="http://www.cnblogs.com/kid-li/rss">Rss</A><A 
  id="MyLinks1_XMLLink" class="aHeaderXML" href="http://www.cnblogs.com/kid-li/rss"><IMG 
  alt="Rss" src="/Skins/Custom/images/rss.gif"></A></LI></UL>
<DIV class="blogStats"><!--done-->Posts - 82&nbsp; Articles - 0&nbsp; Comments - 
438&nbsp;					</DIV><!--end: blogStats --></DIV><!--end: navigator 博客导航栏 -->
</DIV><!--end: header 头部 -->
<DIV id="main">
<DIV id="mainContent">
<DIV class="forFlow"><!--done-->
<DIV id="topics">
<DIV class="post">
<H1 class="postTitle"><A id="cb_post_title_url" class="postTitle2" href="http://www.cnblogs.com/kid-li/archive/2006/11/18/564852.html">设计模式学习笔记（十七）——Command命令模式 
</A></H1>
<DIV class="clear"></DIV>
<DIV class="postBody">
<DIV id="cnblogs_post_body">
<P style="margin: 0cm 0cm 0pt;" class="MsoNormal"><STRONG style="mso-bidi-font-weight: normal;"><SPAN 
lang="EN-US">Command</SPAN></STRONG><STRONG style="mso-bidi-font-weight: normal;"><SPAN 
style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>命令模式介绍：</SPAN><SPAN 
lang="EN-US"><o:p></o:p></SPAN></STRONG></P>
<P style="margin: 0cm 0cm 0pt; text-indent: 21pt;" class="MsoNormal"><SPAN lang="EN-US">Command</SPAN><SPAN 
style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>命令模式是一种对象行为型模式，它主要解决的问题是：在软件构建过程中，“行为请求者”与“行为实现者”通常呈现一种“紧耦合”的问题。如下图：</SPAN></P>
<P><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>
</SPAN>
<DIV align="center" src_cetemp="/images/cnblogs_com/kid-li/Command.jpg"><IMG 
border="0" alt="" src="http://images.cnblogs.com/cnblogs_com/kid-li/Command.jpg" 
width="484" height="103"></DIV>
<P>&nbsp;</P>
<P style="margin: 0cm 0cm 0pt; text-indent: 21pt;" class="MsoNormal"><SPAN 
style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>有时我们必须向某对象提交请求，但并不知道关于被请求的操作或请求的接受者的任何信息，此时无法抵御变化的紧耦合是不合适的。如：需要对行为进行“记录、撤销</SPAN><SPAN 
lang="EN-US">/</SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>重做、事务”等处理。我们所要做的是将依赖关系转化，将紧耦合变为松耦合。则上图的形式转化为如下形式：</SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: center;" class="MsoNormal" align="center"><SPAN 
lang="EN-US"></SPAN></P>
<P style="margin: 0cm 0cm 0pt;" class="MsoNormal"><SPAN lang="EN-US"><SPAN 
style="mso-tab-count: 1;"><BR></SPAN></SPAN>
<DIV align="center" src_cetemp="/images/cnblogs_com/kid-li/Command2.JPG"><IMG 
border="0" alt="" src="http://images.cnblogs.com/cnblogs_com/kid-li/Command2.JPG" 
width="456" height="316"></DIV><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
<P>&nbsp;</P>
<P style="margin: 0cm 0cm 0pt;" class="MsoNormal"><SPAN lang="EN-US"><SPAN 
style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>Command</SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>模式通过将请求本身变成一个对象来使行为请求者可向未指定的应用对象提出请求。</SPAN></P>
<P style="margin: 0cm 0cm 0pt;" class="MsoNormal"><SPAN lang="EN-US"><SPAN 
style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>GoF</SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>《设计模式》中说道：将一个请求封装为一个对象，从而使你可用不同的请求对客户进行参数化；对请求排队或记录请求日志，以及支持可撤销的操作。</SPAN></P>
<P style="margin: 0cm 0cm 0pt;" class="MsoNormal"><STRONG style="mso-bidi-font-weight: normal;"><SPAN 
lang="EN-US">Command</SPAN></STRONG><STRONG style="mso-bidi-font-weight: normal;"><SPAN 
style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>命令模式结构：</SPAN><SPAN 
lang="EN-US"><o:p></o:p></SPAN></STRONG></P>
<P style="margin: 0cm 0cm 0pt;" class="MsoNormal"><STRONG style="mso-bidi-font-weight: normal;"><SPAN 
lang="EN-US"><SPAN 
style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <BR>
</SPAN></SPAN></STRONG></P><STRONG style="mso-bidi-font-weight: normal;">
<DIV align="center" src_cetemp="/images/cnblogs_com/kid-li/Command3.JPG"><IMG 
border="0" alt="" src="http://images.cnblogs.com/cnblogs_com/kid-li/Command3.JPG" 
width="750" height="260"></DIV><BR><o:p></o:p></STRONG>
<P>&nbsp;</P>
<P style="margin: 0cm 0cm 0pt;" class="MsoNormal"><STRONG style="mso-bidi-font-weight: normal;"><SPAN 
lang="EN-US"><o:p>&nbsp;</o:p></SPAN></STRONG></P>
<P style="margin: 0cm 0cm 0pt;" class="MsoNormal"><STRONG style="mso-bidi-font-weight: normal;"><SPAN 
style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>定义场景：</SPAN><SPAN 
lang="EN-US"><o:p></o:p></SPAN></STRONG></P>
<P style="margin: 0cm 0cm 0pt;" class="MsoNormal"><SPAN lang="EN-US"><SPAN 
style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN></SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>现在来看一个场景：对于</SPAN><SPAN 
lang="EN-US">notepad</SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>大家都很熟悉，在我们使用</SPAN><SPAN 
lang="EN-US">notepad</SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>打开一个文档之后，往往做一些操作，如；输入字符</SPAN><SPAN 
lang="EN-US">(Write)</SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>、删除前一个字符（</SPAN><SPAN 
lang="EN-US">Delete</SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>）、撤销刚才的操作（</SPAN><SPAN 
lang="EN-US">UnDo</SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>）。现在我们就用</SPAN><SPAN 
lang="EN-US">Console</SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>程序模拟这个过程。</SPAN></P>
<P style="margin: 0cm 0cm 0pt;" class="MsoNormal"><STRONG style="mso-bidi-font-weight: normal;"><SPAN 
style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>代码实现与结构分析：</SPAN><SPAN 
lang="EN-US"><o:p></o:p></SPAN></STRONG></P>
<P style="margin: 0cm 0cm 0pt;" class="MsoNormal"><SPAN lang="EN-US"><SPAN 
style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN></SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>在实现代码前先说明实现</SPAN><SPAN 
lang="EN-US">Command</SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>模式需要烤炉的一些问题：</SPAN></P>
<P style="margin: 0cm 0cm 0pt 39pt; text-indent: -18pt; mso-list: l0 level1 lfo2; tab-stops: list 39.0pt;" 
class="MsoNormal"><SPAN style='mso-fareast-font-family: "Times New Roman";' 
lang="EN-US"><SPAN style="mso-list: Ignore;">1、<SPAN style='font: 7pt/normal "Times New Roman"; font-size-adjust: none; font-stretch: normal;'>&nbsp; 
</SPAN></SPAN></SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>一个命令对象应达到何种智能程度：命令对象的能力可大可小。这样就出现了两个极端。一是：它仅确定一个接收者和执行该请求的动作；一是：它自己实现所有功能，根本不需要额外的接收者对象。我给他们起了便于我方便记忆的名字，第一种叫</SPAN><SPAN 
lang="EN-US">OperationCommand</SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>，第二种叫</SPAN><SPAN 
lang="EN-US">ObjectCommand</SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>。当然只是为了便于记忆和理解，如有不理解，在代码实现与结构分析最后我会再谈谈我的想法，如有不妥，还请多提意见，一会在下面的代码中会分别对这两种情况进行示范。</SPAN></P>
<P style="margin: 0cm 0cm 0pt 39pt; text-indent: -18pt; mso-list: l0 level1 lfo2; tab-stops: list 39.0pt;" 
class="MsoNormal"><SPAN style='mso-fareast-font-family: "Times New Roman";' 
lang="EN-US"><SPAN style="mso-list: Ignore;">2、<SPAN style='font: 7pt/normal "Times New Roman"; font-size-adjust: none; font-stretch: normal;'>&nbsp; 
</SPAN></SPAN></SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>支持取消和重做：为了达到这个目的</SPAN><SPAN 
lang="EN-US">ConcreteCommand</SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>类中要存储额外的状态信息。也就是上图中</SPAN><SPAN 
lang="EN-US">ConcreteCommand</SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>的</SPAN><SPAN 
lang="EN-US">state</SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>属性。</SPAN></P>
<P style="margin: 0cm 0cm 0pt 39pt; text-indent: -18pt; mso-list: l0 level1 lfo2; tab-stops: list 39.0pt;" 
class="MsoNormal"><SPAN style='mso-fareast-font-family: "Times New Roman";' 
lang="EN-US"><SPAN style="mso-list: Ignore;">3、<SPAN style='font: 7pt/normal "Times New Roman"; font-size-adjust: none; font-stretch: normal;'>&nbsp; 
</SPAN></SPAN></SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>避免取消操作中过程中的错误积累：由于命令重复的执行、取消执行和重执行的过程可能会积累错误，以致一个应用的状态最终偏离初始值。这就有必要在</SPAN><SPAN 
lang="EN-US">Command</SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>中存入更多的信息以保证这些对象可被精确的复原。</SPAN></P>
<P style="margin: 0cm 0cm 0pt 21pt; text-indent: 18pt;" class="MsoNormal"><SPAN 
style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>下面来看看代码上的实现：首先，我先作一个</SPAN><SPAN 
lang="EN-US">OperationCommand</SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>的例子，先做一个请求的接收者</SPAN><SPAN 
lang="EN-US">Document</SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>（也就是结构图中的</SPAN><SPAN 
lang="EN-US">Receiver</SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>）</SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='color: blue; font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">class</SPAN><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"> <SPAN style="color: teal;">Document<o:p></o:p></SPAN></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">public</SPAN> <SPAN 
style="color: blue;">string</SPAN> strContent;<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><o:p>&nbsp;</o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">public</SPAN> Document()<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>strContent = <SPAN 
style="color: maroon;">""</SPAN>;<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>}<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">}<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><o:p>&nbsp;</o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-indent: 21pt;" class="MsoNormal"><SPAN 
style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;'>在这个程序中我们还要定义一个抽象类<SPAN 
lang="EN-US">Command</SPAN>，对于<SPAN 
lang="EN-US">OperationCommand</SPAN>类型来说，它仅确定一个接收者和执行该请求的动作。所以，在抽象类<SPAN lang="EN-US">Command</SPAN>中，只声明一个<SPAN 
lang="EN-US">Excute</SPAN>的方法。这个方法在其子类中进行实现。（当然这个<SPAN 
lang="EN-US">Command</SPAN>还可以定义成接口）<SPAN 
lang="EN-US"><o:p></o:p></SPAN></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='color: blue; font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">abstract</SPAN><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"> <SPAN style="color: blue;">class</SPAN> <SPAN 
style="color: teal;">Command<o:p></o:p></SPAN></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">public</SPAN> Command()<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{ 
}<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">public</SPAN> <SPAN 
style="color: blue;">abstract</SPAN> <SPAN style="color: blue;">void</SPAN> 
Excute();<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-indent: 21pt;" class="MsoNormal"><SPAN 
style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">}<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-indent: 21pt;" class="MsoNormal"><SPAN 
style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><o:p>&nbsp;</o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-indent: 21pt;" class="MsoNormal"><SPAN 
style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;'>接下来，就要实现各种操作（结构图中的<SPAN 
lang="EN-US">ConcreteCommand</SPAN>），代码如下<SPAN 
lang="EN-US"><o:p></o:p></SPAN></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-indent: 21pt;" class="MsoNormal"><SPAN 
style='color: rgb(51, 153, 102); font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">//</SPAN><SPAN style='color: rgb(51, 153, 102); font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;'>写操作<SPAN 
lang="EN-US"><o:p></o:p></SPAN></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='color: blue; font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">class</SPAN><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"> <SPAN style="color: teal;">WriteCommand</SPAN> : <SPAN style="color: teal;">Command<o:p></o:p></SPAN></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: teal;">Document</SPAN> doc;<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: teal;">ArrayList</SPAN> 
ObjectState;<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">public</SPAN> WriteCommand(<SPAN style="color: teal;">Document</SPAN> 
doc, <SPAN style="color: teal;">ArrayList</SPAN> state)<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">this</SPAN>.doc = doc;<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>ObjectState = state;<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>}<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><o:p>&nbsp;</o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">public</SPAN> <SPAN 
style="color: blue;">override</SPAN> <SPAN style="color: blue;">void</SPAN> 
Excute()<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>doc.strContent += <SPAN 
style="color: teal;">Console</SPAN>.ReadLine();<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>ObjectState.Add(doc.strContent);<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>}<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; 
</SPAN>}<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; 
</SPAN><o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='color: rgb(51, 153, 102); font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; 
</SPAN>//</SPAN><SPAN style='color: rgb(51, 153, 102); font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;'>删除操作<SPAN 
lang="EN-US"><o:p></o:p></SPAN></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </SPAN><SPAN 
style="color: blue;">class</SPAN> <SPAN 
style="color: teal;">DeleteCommand</SPAN> : <SPAN 
style="color: teal;">Command<o:p></o:p></SPAN></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: teal;">Document</SPAN> doc;<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: teal;">ArrayList</SPAN> 
ObjectState;<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">public</SPAN> DeleteCommand(<SPAN style="color: teal;">Document</SPAN> 
doc, <SPAN style="color: teal;">ArrayList</SPAN> state)<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">this</SPAN>.doc = doc;<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>ObjectState = state;<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>}<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><o:p>&nbsp;</o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">public</SPAN> <SPAN 
style="color: blue;">override</SPAN> <SPAN style="color: blue;">void</SPAN> 
Excute()<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>doc.strContent = doc.strContent.Substring(0, doc.strContent.Length - 
1);<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>ObjectState.Add(doc.strContent);<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>}<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; 
</SPAN>}<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><o:p>&nbsp;</o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='color: rgb(51, 153, 102); font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; 
</SPAN>//</SPAN><SPAN style='color: rgb(51, 153, 102); font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;'>撤销操作<SPAN 
lang="EN-US"><o:p></o:p></SPAN></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </SPAN><SPAN 
style="color: blue;">class</SPAN> <SPAN style="color: teal;">UnDoCommand</SPAN> 
: <SPAN style="color: teal;">Command<o:p></o:p></SPAN></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: teal;">Document</SPAN> doc;<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: teal;">ArrayList</SPAN> 
ObjectState;<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">public</SPAN> UnDoCommand(<SPAN style="color: teal;">Document</SPAN> 
doc, <SPAN style="color: teal;">ArrayList</SPAN> state)<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">this</SPAN>.doc = doc;<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>ObjectState = state;<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>}<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><o:p>&nbsp;</o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">public</SPAN> <SPAN 
style="color: blue;">override</SPAN> <SPAN style="color: blue;">void</SPAN> 
Excute()<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>doc.strContent = (<SPAN 
style="color: blue;">string</SPAN>)ObjectState[ObjectState.Count - 
2];<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>ObjectState.Add(doc.strContent);<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>}<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-indent: 18pt;" class="MsoNormal"><SPAN 
style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">}<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-indent: 18pt;" class="MsoNormal"><SPAN 
style='font-family: 新宋体; font-size: 9pt; mso-hansi-font-family: "Times New Roman"; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><o:p>&nbsp;</o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-indent: 21pt;" class="MsoNormal"><SPAN 
style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;'>实现了各种操作后，编写一个客户代码进行测试</SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='color: blue; font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">class</SPAN><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"> <SPAN style="color: teal;">Program<o:p></o:p></SPAN></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">static</SPAN> <SPAN 
style="color: blue;">void</SPAN> <st1:place w:st="on">Main</st1:place>(<SPAN 
style="color: blue;">string</SPAN>[] args)<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: teal;">Document</SPAN> doc = <SPAN style="color: blue;">new</SPAN> 
<SPAN style="color: teal;">Document</SPAN>();<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: teal;">Console</SPAN>.WriteLine(<SPAN style="color: maroon;">"Please 
Input next operation:"</SPAN>);<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">string</SPAN> strOperation = <SPAN style="color: teal;">Console</SPAN>.ReadLine();<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </SPAN><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="color: teal;">Command</SPAN> com = <SPAN 
style="color: blue;">null</SPAN>;<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: teal;">ArrayList</SPAN> ObjectState = <SPAN style="color: blue;">new</SPAN> 
<SPAN style="color: teal;">ArrayList</SPAN>();<SPAN 
style="color: green;">//Record state<o:p></o:p></SPAN></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">while</SPAN> (strOperation != <SPAN style="color: maroon;">"Exit"</SPAN>)<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">switch</SPAN> 
(strOperation.ToLower())<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">case</SPAN> <SPAN 
style="color: maroon;">"write"</SPAN>:<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </SPAN><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN>com 
= <SPAN style="color: blue;">new</SPAN> <SPAN 
style="color: teal;">WriteCommand</SPAN>(doc, 
ObjectState);<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>com.Excute();<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: teal;">Console</SPAN>.WriteLine(<SPAN style="color: maroon;">"Write 
Operation:"</SPAN> + doc.strContent);<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">break</SPAN>;<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">case</SPAN> <SPAN 
style="color: maroon;">"<st1:state w:st="on"><st1:place 
w:st="on">del</st1:place></st1:state>"</SPAN>:<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN>com 
= <SPAN style="color: blue;">new</SPAN> <SPAN 
style="color: teal;">DeleteCommand</SPAN>(doc, 
ObjectState);<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>com.Excute();<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: teal;">Console</SPAN>.WriteLine(<SPAN style="color: maroon;">"Delete 
Operation:"</SPAN> + doc.strContent);<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">break</SPAN>;<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">case</SPAN> <SPAN 
style="color: maroon;">"undo"</SPAN>:<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN>com 
= <SPAN style="color: blue;">new</SPAN> <SPAN 
style="color: teal;">UnDoCommand</SPAN>(doc, ObjectState);<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>com.Excute();<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: teal;">Console</SPAN>.WriteLine(<SPAN style="color: maroon;">"UnDo 
Operation:"</SPAN> + doc.strContent);<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">break</SPAN>;<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">default</SPAN>:<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: teal;">Console</SPAN>.WriteLine(<SPAN style="color: maroon;">"Wrong 
Operation:"</SPAN>);<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">break</SPAN>;<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>}<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: teal;">Console</SPAN>.WriteLine(<SPAN style="color: maroon;">"Please 
Input next operation:"</SPAN>);<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>strOperation = <SPAN 
style="color: teal;">Console</SPAN>.ReadLine();<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>}<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>}<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">}<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><o:p>&nbsp;</o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;'>测试结果：<SPAN 
lang="EN-US"><o:p></o:p></SPAN></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">Please Input next operation:<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">write<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">k<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">Write Operation:k<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">Please Input next operation:<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">write<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">i<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">Write Operation:ki<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">Please Input next operation:<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">write<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">d<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">Write Operation:kid<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">Please Input next operation:<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">write<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">d<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">Write Operation:kidd<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">Please Input next operation:<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><st1:state w:st="on"><st1:place w:st="on"><SPAN 
style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">del</SPAN></st1:place></st1:state><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">Delete Operation:kid<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">Please Input next operation:<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">undo<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">UnDo Operation:kidd<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">Please Input next operation:<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><o:p>&nbsp;</o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;'>下面再来实现以下<SPAN 
lang="EN-US">ObjectCommand</SPAN>的例子，首先还是编写一个已存在的请求接收者<SPAN 
lang="EN-US">Document</SPAN>（结构图中的<SPAN lang="EN-US">Receiver</SPAN>）<SPAN lang="EN-US"><o:p></o:p></SPAN></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='color: blue; font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">class</SPAN><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"> <SPAN style="color: teal;">Document<o:p></o:p></SPAN></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">public</SPAN> <SPAN 
style="color: blue;">string</SPAN> strContent;<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><o:p>&nbsp;</o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">public</SPAN> Document()<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>strContent = <SPAN 
style="color: maroon;">""</SPAN>;<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>}<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">}<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><o:p>&nbsp;</o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;'>接下来实现抽象类<SPAN 
lang="EN-US">Command</SPAN>（也可以使用接口），对于<SPAN 
lang="EN-US">ObjectCommand</SPAN>类型来说，</SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>它自己实现所有功能，根本不需要额外的接收者对象，所以在</SPAN><SPAN 
lang="EN-US">Command</SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>中声明了所有的操作</SPAN><SPAN 
style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='color: blue; font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">abstract</SPAN><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"> <SPAN style="color: blue;">class</SPAN> <SPAN 
style="color: teal;">Command<o:p></o:p></SPAN></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">public</SPAN> Command()<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>{<SPAN style="mso-spacerun: yes;">&nbsp; </SPAN>}<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><o:p>&nbsp;</o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">public</SPAN> <SPAN 
style="color: blue;">abstract</SPAN> <SPAN style="color: blue;">void</SPAN> 
Write();<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">public</SPAN> <SPAN 
style="color: blue;">abstract</SPAN> <SPAN style="color: blue;">void</SPAN> 
Delete();<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">public</SPAN> <SPAN 
style="color: blue;">abstract</SPAN> <SPAN style="color: blue;">void</SPAN> 
UnDo();<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">}<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><o:p>&nbsp;</o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;'>有了<SPAN 
lang="EN-US">Command</SPAN>，就可以实现具体的操作类型<SPAN 
lang="EN-US">DocumentCommand</SPAN>（结构图中的<SPAN 
lang="EN-US">ConcreteCommand</SPAN>）<SPAN 
lang="EN-US"><o:p></o:p></SPAN></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='color: blue; font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">class</SPAN><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"> <SPAN style="color: teal;">DocumentCommand</SPAN> : <SPAN style="color: teal;">Command<o:p></o:p></SPAN></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">private</SPAN> <SPAN 
style="color: teal;">Document</SPAN> doc;<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">private</SPAN> <SPAN 
style="color: teal;">ArrayList</SPAN> ObjectState = <SPAN 
style="color: blue;">new</SPAN> <SPAN 
style="color: teal;">ArrayList</SPAN>();<SPAN style="color: green;">//Record 
State<o:p></o:p></SPAN></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">public</SPAN> DocumentCommand(<SPAN style="color: teal;">Document</SPAN> 
doc)<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">this</SPAN>.doc = doc;<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>}<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><o:p>&nbsp;</o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN style="mso-spacerun: yes;">&nbsp;</SPAN><SPAN style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">public</SPAN> <SPAN 
style="color: blue;">override</SPAN> <SPAN style="color: blue;">void</SPAN> 
Write()<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: teal;">Console</SPAN>.WriteLine(<SPAN style="color: maroon;">"Please 
input an character:"</SPAN>);<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">string</SPAN> strRead = <SPAN style="color: teal;">Console</SPAN>.ReadLine();<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>doc.strContent += strRead;<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>ObjectState.Add(doc.strContent);<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>}<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><o:p>&nbsp;</o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="color: blue;">public</SPAN> 
<SPAN style="color: blue;">override</SPAN> <SPAN 
style="color: blue;">void</SPAN> Delete()<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>doc.strContent = doc.strContent.Substring(0, doc.strContent.Length - 
1);<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>ObjectState.Add(doc.strContent);<SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>}<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><o:p>&nbsp;</o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">public</SPAN> <SPAN 
style="color: blue;">override</SPAN> <SPAN style="color: blue;">void</SPAN> 
UnDo()<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>doc.strContent = (<SPAN 
style="color: blue;">string</SPAN>)ObjectState[ObjectState.Count - 
2];<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>ObjectState.Add(doc.strContent);<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>}<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">}<SPAN style="mso-spacerun: yes;">&nbsp;&nbsp; 
</SPAN><o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><o:p>&nbsp;</o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;'>接下来就用一个客户端代码作一下测试<SPAN 
lang="EN-US"><o:p></o:p></SPAN></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='color: blue; font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">class</SPAN><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"> <SPAN style="color: teal;">Program<o:p></o:p></SPAN></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">static</SPAN> <SPAN 
style="color: blue;">void</SPAN> <st1:place w:st="on">Main</st1:place>(<SPAN 
style="color: blue;">string</SPAN>[] args)<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: teal;">Document</SPAN> doc = <SPAN style="color: blue;">new</SPAN> 
<SPAN style="color: teal;">Document</SPAN>();<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="color: teal;">DocumentCommand</SPAN> com = <SPAN 
style="color: blue;">new</SPAN> <SPAN 
style="color: teal;">DocumentCommand</SPAN>(doc);<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: teal;">Console</SPAN>.WriteLine(<SPAN style="color: maroon;">"Please 
Input next operation:"</SPAN>);<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">string</SPAN> strOperation = <SPAN style="color: teal;">Console</SPAN>.ReadLine();<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">while</SPAN> (strOperation != <SPAN style="color: maroon;">"Exit"</SPAN>)<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">switch</SPAN> 
(strOperation.ToLower())<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">case</SPAN> <SPAN 
style="color: maroon;">"write"</SPAN>:<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>com.Write();<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: teal;">Console</SPAN>.WriteLine(<SPAN style="color: maroon;">"Write 
Operation:"</SPAN> + doc.strContent);<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">break</SPAN>;<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">case</SPAN> <SPAN 
style="color: maroon;">"<st1:state w:st="on"><st1:place 
w:st="on">del</st1:place></st1:state>"</SPAN>:<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN style="mso-spacerun: yes;">&nbsp;&nbsp; </SPAN><SPAN style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN>com.Delete();<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: teal;">Console</SPAN>.WriteLine(<SPAN style="color: maroon;">"Delete 
Operation:"</SPAN> + doc.strContent);<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">break</SPAN>;<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">case</SPAN> <SPAN 
style="color: maroon;">"undo"</SPAN>:<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>com.UnDo();<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: teal;">Console</SPAN>.WriteLine(<SPAN style="color: maroon;">"UnDo 
Operation:"</SPAN> + doc.strContent);<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">break</SPAN>;<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">default</SPAN>:<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: teal;">Console</SPAN>.WriteLine(<SPAN style="color: maroon;">"Wrong 
Operation:"</SPAN>);<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: blue;">break</SPAN>;<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>}<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="color: teal;">Console</SPAN>.WriteLine(<SPAN style="color: maroon;">"Please 
Input next operation:"</SPAN>);<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>strOperation = <SPAN 
style="color: teal;">Console</SPAN>.ReadLine();<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>}<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN 
style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>}<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><SPAN style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; 
</SPAN>}<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><o:p>&nbsp;</o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;'>测试结果如下：<SPAN 
lang="EN-US"><o:p></o:p></SPAN></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">Please Input next operation:<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">write<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">Please input an character:<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">k<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">Write Operation:k<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">Please Input next operation:<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">write<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">Please input an character:<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">i<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">Write Operation:ki<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">Please Input next operation:<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">write<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">Please input an character:<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">d<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">Write Operation:kid<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">Please Input next operation:<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">write<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">Please input an character:<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">d<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">Write Operation:kidd<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">Please Input next operation:<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><st1:state w:st="on"><st1:place w:st="on"><SPAN 
style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">del</SPAN></st1:place></st1:state><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">Delete Operation:kid<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">Please Input next operation:<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">undo<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">UnDo Operation:kidd<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US">Please Input next operation:<o:p></o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;' 
lang="EN-US"><o:p>&nbsp;</o:p></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-align: left; text-indent: 21pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;'>这两个程序中需要有几点说明：<SPAN 
lang="EN-US"><o:p></o:p></SPAN></SPAN></P>
<P style="margin: 0cm 0cm 0pt 57.75pt; text-align: left; text-indent: -36.75pt; mso-list: l2 level1 lfo3; tab-stops: list 57.75pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes; mso-bidi-font-family: 新宋体;' 
lang="EN-US"><SPAN style="mso-list: Ignore;">1、<SPAN style='font: 7pt/normal "Times New Roman"; font-size-adjust: none; font-stretch: normal;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN></SPAN></SPAN><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;'>对于<SPAN 
lang="EN-US">OperationCommand</SPAN>，我的理解是它所实现的<SPAN 
lang="EN-US">Command</SPAN>只是某一个操作对于某一个接收者，所以我给它取名为<SPAN 
lang="EN-US">OperationCommand</SPAN>。对于<SPAN 
lang="EN-US">ObjectCommand</SPAN>，是实现这样一种对象，它实现了请求接收者的所有操作，所以取名为<SPAN lang="EN-US">ObjectCommand<o:p></o:p></SPAN></SPAN></P>
<P style="margin: 0cm 0cm 0pt 57.75pt; text-align: left; text-indent: -36.75pt; mso-list: l2 level1 lfo3; tab-stops: list 57.75pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes; mso-bidi-font-family: 新宋体;' 
lang="EN-US"><SPAN style="mso-list: Ignore;">2、<SPAN style='font: 7pt/normal "Times New Roman"; font-size-adjust: none; font-stretch: normal;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN></SPAN></SPAN><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;'>在代码实例中，我对状态的保存处理相对简单，但这是因为利用了<SPAN 
lang="EN-US">String</SPAN>对象的特点，当<SPAN 
lang="EN-US">String</SPAN>对象被修改时，系统会重新分配一块内存。不修改原内存上的内容。如果是要保存其他的引用类型应当注意使用深拷贝，否则，所保存的状态对象都指向一个内存地址，随着状态的改变，保存不了原有的状态。<SPAN 
lang="EN-US"><o:p></o:p></SPAN></SPAN></P>
<P style="margin: 0cm 0cm 0pt 57.75pt; text-align: left; text-indent: -36.75pt; mso-list: l2 level1 lfo3; tab-stops: list 57.75pt; mso-layout-grid-align: none;" 
class="MsoNormal" align="left"><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes; mso-bidi-font-family: 新宋体;' 
lang="EN-US"><SPAN style="mso-list: Ignore;">3、<SPAN style='font: 7pt/normal "Times New Roman"; font-size-adjust: none; font-stretch: normal;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN></SPAN></SPAN><SPAN style='font-family: 新宋体; mso-hansi-font-family: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-no-proof: yes;'>在对象状态的保存上，我们可以使用<SPAN 
lang="EN-US">Prototype</SPAN>模式。<SPAN lang="EN-US"><o:p></o:p></SPAN></SPAN></P>
<P style="margin: 0cm 0cm 0pt; text-indent: 18pt;" class="MsoNormal"><STRONG 
style="mso-bidi-font-weight: normal;"><SPAN 
lang="EN-US">Command</SPAN></STRONG><STRONG style="mso-bidi-font-weight: normal;"><SPAN 
style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>模式的几个要点：</SPAN><SPAN 
lang="EN-US"><o:p></o:p></SPAN></STRONG></P>
<P style="margin: 0cm 0cm 0pt 18pt; text-indent: -18pt; mso-list: l1 level1 lfo1; tab-stops: list 18.0pt;" 
class="MsoNormal"><SPAN style='mso-fareast-font-family: "Times New Roman";' 
lang="EN-US"><SPAN style="mso-list: Ignore;">1、<SPAN style='font: 7pt/normal "Times New Roman"; font-size-adjust: none; font-stretch: normal;'>&nbsp; 
</SPAN></SPAN></SPAN><SPAN lang="EN-US">Command</SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>模式的根本目的在于将“行为请求者”与“行为实现者”解耦，在面向对象语言中，常见的实现手段是“将行为抽象为对象”。</SPAN></P>
<P style="margin: 0cm 0cm 0pt 18pt; text-indent: -18pt; mso-list: l1 level1 lfo1; tab-stops: list 18.0pt;" 
class="MsoNormal"><SPAN style='mso-fareast-font-family: "Times New Roman";' 
lang="EN-US"><SPAN style="mso-list: Ignore;">2、<SPAN style='font: 7pt/normal "Times New Roman"; font-size-adjust: none; font-stretch: normal;'>&nbsp; 
</SPAN></SPAN></SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>实现</SPAN><SPAN 
lang="EN-US">Command</SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>接口的具体命令对象</SPAN><SPAN 
lang="EN-US">ConcreteCommand </SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>有时候根据需要可能会保存一些额外的状态信息。</SPAN></P>
<P style="margin: 0cm 0cm 0pt 18pt; text-indent: -18pt; mso-list: l1 level1 lfo1; tab-stops: list 18.0pt;" 
class="MsoNormal"><SPAN style='mso-fareast-font-family: "Times New Roman";' 
lang="EN-US"><SPAN style="mso-list: Ignore;">3、<SPAN style='font: 7pt/normal "Times New Roman"; font-size-adjust: none; font-stretch: normal;'>&nbsp; 
</SPAN></SPAN></SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>通过使用</SPAN><SPAN 
lang="EN-US">Composite</SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>模式，可以将多个“命名”封装为一个“复合命令”</SPAN><SPAN 
lang="EN-US">MacroCommand</SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>。</SPAN></P>
<P style="margin: 0cm 0cm 0pt 18pt; text-indent: -18pt; mso-list: l1 level1 lfo1; tab-stops: list 18.0pt;" 
class="MsoNormal"><SPAN style='mso-fareast-font-family: "Times New Roman";' 
lang="EN-US"><SPAN style="mso-list: Ignore;">4、<SPAN style='font: 7pt/normal "Times New Roman"; font-size-adjust: none; font-stretch: normal;'>&nbsp; 
</SPAN></SPAN></SPAN><SPAN lang="EN-US">Command</SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>模式与</SPAN><SPAN 
lang="EN-US">C#</SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>中的</SPAN><SPAN 
lang="EN-US">Delegate</SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>有些类似。但两者定义行为接口的规范有所区别：</SPAN><SPAN 
lang="EN-US">Command</SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>以面向对象中的“接口</SPAN><SPAN 
lang="EN-US">-</SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>实现”类定义行为接口规范，更严格，更符合抽象原则：</SPAN><SPAN 
lang="EN-US">Delegate</SPAN><SPAN style='font-family: 宋体; mso-ascii-font-family: "Times New Roman"; mso-hansi-font-family: "Times New Roman";'>以函数签名来定义行为接口规范，更灵活，但抽象能力比较弱</SPAN></P>
</DIV>
<DIV id="MySignature"></DIV>
<SCRIPT type="text/javascript">
var isLogined = false;
var cb_blogId = 14903;
var cb_entryId = 564852;
var cb_blogApp = currentBlogApp;
var cb_blogUserGuid = "ae46360b-63cf-dd11-9e4d-001cf0cd104b";
var cb_entryCreatedDate = '2006/11/18 22:59:00';
var enableGoogleAd = true;
var googletag = googletag || {};
googletag.cmd = googletag.cmd || [];
</SCRIPT>

<DIV class="clear"></DIV>
<DIV id="blog_post_info_block">
<DIV id="blog_post_info">
<DIV id="BlogPostCategory">分类: <A href="http://www.cnblogs.com/kid-li/category/44668.html">设计模式</A></DIV>
<DIV id="EntryTag"></DIV>
<DIV id="green_channel">绿色通道：<A id="green_channel_digg" onclick="DiggIt(cb_entryId,cb_blogId,1);green_channel_success(this,'谢谢推荐！');" 
href="javascript:void(0);">好文要顶</A><A id="green_channel_follow" onclick="c_follow();" 
href="javascript:void(0);">关注我</A><A id="green_channel_favorite" onclick="AddToWz(cb_entryId);return false;" 
href="javascript:void(0);">收藏该文</A><A id="green_channel_contact" href="http://space.cnblogs.com/msg/send/KiddLee" 
target="_blank">与我联系</A><A id="green_channel_weibo" title="分享至新浪微博" onclick="ShareToTsina()" 
href="javascript:void(0);"><IMG alt="" src="http://static.cnblogs.com/images/icon_weibo_24.png"></A>
</DIV>
<DIV id="digg_block">
<DIV id="author_profile">
<DIV id="author_profile_info" class="author_profile_info">
<DIV id="author_profile_detail" class="author_profile_info"><A href="http://home.cnblogs.com/u/kid-li/">KiddLee</A><BR>
<A href="http://home.cnblogs.com/u/kid-li/followees">关注 - 0</A><BR><A href="http://home.cnblogs.com/u/kid-li/followers">粉丝 
- 45</A></DIV></DIV>
<DIV class="clear"></DIV>
<DIV id="author_profile_honor"></DIV>
<DIV id="author_profile_follow"><A onclick="c_follow();return false;" href="javascript:void(0);">+加关注</A>
</DIV></DIV>
<DIV id="div_digg">
<DIV class="diggit" onclick="votePost(cb_entryId,'Digg')"><SPAN id="digg_count" 
class="diggnum">0</SPAN></DIV>
<DIV class="buryit" onclick="votePost(cb_entryId,'Bury')"><SPAN id="bury_count" 
class="burynum">0</SPAN></DIV>
<DIV class="clear"></DIV>
<DIV id="digg_tips" class="diggword">    (请您对文章做出评价)    </DIV></DIV></DIV></DIV>
<DIV class="clear"></DIV>
<DIV id="post_next_prev"><A class="p_n_p_prefix" href="http://www.cnblogs.com/kid-li/archive/2006/11/17/563961.html">« 
</A> 博主上一篇：<A title="发布于2006-11-17 18:56" href="http://www.cnblogs.com/kid-li/archive/2006/11/17/563961.html">三层体系结构总结（四）</A><BR><A 
class="p_n_p_prefix" href="http://www.cnblogs.com/kid-li/archive/2006/11/23/570293.html">» 
</A> 博主下一篇：<A title="发布于2006-11-23 20:55" href="http://www.cnblogs.com/kid-li/archive/2006/11/23/570293.html">CMMI3学习之路（一）：在质疑与挣扎中偶然发现她竟是如此美丽</A><BR><A 
class="p_n_p_prefix" href="http://www.cnblogs.com/chnking/archive/2006/11/18/564827.html">« 
</A> 首页上一篇：<A href="http://www.cnblogs.com/chnking/archive/2006/11/18/564827.html">biztalk与工作流/业务流程以及WWF</A><BR><A 
class="p_n_p_prefix" href="http://www.cnblogs.com/lijigang/archive/2006/11/18/564853.html">» 
</A> 首页下一篇：<A href="http://www.cnblogs.com/lijigang/archive/2006/11/18/564853.html">Web服务初探：用Demo学Web服务系列（6）——断开模式访问数据库的Web服务</A><BR></DIV>
</DIV>
<SCRIPT type="text/javascript">
    //SyntaxHighlighter.config.strings.expandSource = '<span><img src="http://static.cnblogs.com/images/expand-code.gif" alt="" class="expand-code-icon"/>View Code</span>';
    $(function () {             
        fixPostBodyFormat();
        loadAdUnderPost();
        loadBlogSignature();
        LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
        GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);        
        GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);        
    });
</SCRIPT>
</DIV>
<DIV class="postDesc">posted @ <SPAN id="post-date">2006-11-18 22:59</SPAN> <A 
href="http://www.cnblogs.com/kid-li/">KiddLee</A> Views(10905) Comments(<SPAN 
id="post-comment-count">2</SPAN>)  <A href="http://www.cnblogs.com/kid-li/admin/EditPosts.aspx?postid=564852" 
rel="nofollow">Edit</A> <A onclick="AddToWz(564852);return false;" 
href="#">收藏</A></DIV></DIV><IMG alt="" src="http://www.cnblogs.com/kid-li/aggbug/564852.html?type=1&amp;webview=1" 
width="1" height="1"></DIV>
<DIV id="blog-comments-placeholder">
<DIV id="comments_pager_top"></DIV><!--done--><BR>
<DIV class="feedback_area_title">    Post Comment</DIV>
<DIV class="feedbackNoItems"></DIV>
<DIV class="feedbackItem">
<DIV class="feedbackListSubtitle">
<DIV class="feedbackManage">                    &nbsp;&nbsp;<SPAN class="comment_actions"></SPAN></DIV><A 
class="layer" href="#1419465">#1楼</A><A id="comment_anchor_1419465" name="1419465"></A><SPAN 
style="display: none;" id="comment-maxId">1419465</SPAN><SPAN style="display: none;" 
id="comment-maxDate">2009/1/2 19:46:36</SPAN> <SPAN 
class="comment_date">2009-01-02 19:46</SPAN>                |                <A 
id="a_comment_author_1419465" href="http://www.cnblogs.com/pillow/" target="_blank">pillow</A> 
<A class="sendMsg2This" title="发送站内短消息" href="http://space.cnblogs.com/msg/send/pillow">&nbsp;</A></DIV>
<DIV class="feedbackCon">
<DIV id="comment_body_1419465" class="blog_comment_body"><IMG style="display: none;" 
id="comment_1419465_avatar" class="comment-avatar" alt="" src="http://pic.cnitblog.com/face/u45920.jpg">受益匪浅!命令模式我一直有这个概念.知道请求者和实现者可以实现解藕.但是没有更多体会这种解藕的具体用途.这次更进一步了.^_^.谢谢!</DIV>
<DIV class="comment_vote"><A class="comment_digg" onclick="return voteComment(1419465,'Digg',this)" 
href="javascript:void(0);">支持(0)</A><A class="comment_bury" onclick="return voteComment(1419465,'Bury',this)" 
href="javascript:void(0);">反对(0)</A></DIV><BR></DIV></DIV>
<DIV id="comments_pager_bottom"></DIV></DIV>
<SCRIPT type="text/javascript">var commentManager = new blogCommentManager();commentManager.loadComments();</SCRIPT>

<DIV id="comment_form" class="commentform">
<DIV id="divCommentShow"></DIV>
<DIV id="comment_nav"><SPAN id="span_refresh_tips"></SPAN><A id="lnk_RefreshComments" 
onclick="return RefreshCommentList();" href="javascript:void(0);">刷新评论</A><A 
onclick="return RefreshPage();" href="#">刷新页面</A><A href="#top">返回顶部</A></DIV>
<DIV id="comment_form_container">
<DIV class="login_tips">注册用户登录后才能发表评论，请 <A class="underline" onclick="return login('commentform');" 
href="javascript:void(0);" rel="nofollow">登录</A> 或 <A class="underline" onclick="return register();" 
href="javascript:void(0);" rel="nofollow">注册</A>，<A href="http://www.cnblogs.com">访问</A>网站首页。</DIV></DIV>
<SCRIPT type="text/javascript">if (typeof commentManager === 'undefined') {
        commentManager = new blogCommentManager();
    }
    commentManager.loadCommentForm();   
</SCRIPT>

<DIV id="ad_text_under_commentbox" class="ad_text_commentbox"></DIV>
<DIV id="site_nav_under"><A title="程序员的网上家园" href="http://www.cnblogs.com/" 
target="_blank">博客园首页</A><A title="程序员问答社区" href="http://q.cnblogs.com/" target="_blank">博问</A><A 
title="IT新闻" href="http://news.cnblogs.com/" target="_blank">新闻</A><A href="http://home.cnblogs.com/ing/" 
target="_blank">闪存</A><A href="http://job.cnblogs.com/" 
target="_blank">程序员招聘</A><A href="http://kb.cnblogs.com/" 
target="_blank">知识库</A></DIV>
<DIV id="ad_under_post_holder">
<DIV id="google_ad_c1" class="c_ad_block"><!-- cnblogs_blogpost_C1_sitehome -->
<DIV style="width: 300px; height: 250px;" 
id="div-gpt-ad-1346480159711-0"><IFRAME style="border: 0px currentColor;" id="google_ads_iframe_/1090369/cnblogs_blogpost_C1_sitehome_0" 
height="250" marginHeight="0" src="javascript:'<script type=&quot;text/javascript&quot;>document.domain = &quot;cnblogs.com&quot;;var adContent = window.parent[&quot;google-ad-content-ms0buh9na35u&quot;];window.parent[&quot;google-ad-content-ms0buh9na35u&quot;] = null;document.write(adContent);document.close();</script>'" 
frameBorder="0" width="300" name="google_ads_iframe_/1090369/cnblogs_blogpost_C1_sitehome_0" 
marginWidth="0" scrolling="no"></IFRAME></DIV></DIV>
<DIV id="blog_news_kb">
<DIV class="itnews c_ad_block"><B>最新IT新闻</B>:<BR> ·  <A href="http://news.cnblogs.com/n/171782/" 
target="_blank">SAP联合创始人承诺捐一半身家做慈善</A><BR> ·  <A href="http://news.cnblogs.com/n/171781/" 
target="_blank">眼中的微软形象：生产 通信和娱乐</A><BR> ·  <A href="http://news.cnblogs.com/n/171780/" 
target="_blank">黑莓10手机2月25日进入印度 分析师悲观</A><BR> ·  <A href="http://news.cnblogs.com/n/171779/" 
target="_blank">百度诉360案进入诉讼程序 庭前调解协商未果</A><BR> ·  <A href="http://news.cnblogs.com/n/171778/" 
target="_blank">Facebook股东登广告要求公司合理利用现金</A><BR>» <A title="IT新闻" href="http://news.cnblogs.com/" 
target="_blank">更多新闻...</A></DIV>
<DIV id="kb_block" class="itnews c_ad_block"><B>最新知识库文章</B>:<BR>
<DIV id="kb_recent"> ·  <A href="http://kb.cnblogs.com/page/157115/" target="_blank">走向“持续部署”</A><BR> 
·  <A href="http://kb.cnblogs.com/page/114034/" target="_blank">curl 
网站开发指南</A><BR> ·  <A href="http://kb.cnblogs.com/page/160066/" 
target="_blank">有关T-SQL的10个好习惯</A><BR> ·  <A href="http://kb.cnblogs.com/page/165472/" 
target="_blank">开发者，别让任何人绑架你的工作节奏</A><BR> ·  <A href="http://kb.cnblogs.com/page/169122/" 
target="_blank">冯大辉：十年莽撞 IT 路</A><BR></DIV>» <A href="http://kb.cnblogs.com/" 
target="_blank">更多知识库文章...</A></DIV></DIV>
<DIV id="google_ad_c2" class="c_ad_block"><!-- cnblogs_blogpost_C2_sitehome -->
<DIV style="width: 468px; height: 60px;" id="div-gpt-ad-1346479110744-1"><IFRAME 
style="border: 0px currentColor;" id="google_ads_iframe_/1090369/cnblogs_blogpost_C2_sitehome_0" 
height="60" marginHeight="0" src="javascript:'<script type=&quot;text/javascript&quot;>document.domain = &quot;cnblogs.com&quot;;var adContent = window.parent[&quot;google-ad-content-ixh5cdgt5szm&quot;];window.parent[&quot;google-ad-content-ixh5cdgt5szm&quot;] = null;document.write(adContent);document.close();</script>'" 
frameBorder="0" width="468" name="google_ads_iframe_/1090369/cnblogs_blogpost_C2_sitehome_0" 
marginWidth="0" scrolling="no"></IFRAME></DIV></DIV></DIV>
<DIV id="HistoryToday" class="c_ad_block"></DIV>
</DIV></DIV><!--end: forFlow --></DIV><!--end: mainContent 主体内容容器-->
<DIV id="sideBar">
<DIV id="sideBarMain"><!--done-->
<DIV class="newsItem">
<H3 class="catListTitle">公告</H3>
<DIV id="blog-news">本名：李舒磊<BR>邮箱：kid_li@126.com<BR>msn：kiddlee@hotmail.com<BR>
<BR><FONT color="red">访问统计</FONT><BR><!-- Start of StatCounter Code --><SPAN 
class="statcounter"><A class="statcounter" href="http://www.statcounter.com" 
target="_blank"><IMG border="0" alt="StatCounter - Free Web Tracker and Counter" 
src="http://c.statcounter.com/t.php?sc_project=2035479&amp;resolution=1366&amp;h=768&amp;camefrom=&amp;u=http%3A//www.cnblogs.com/kid-li/archive/2006/11/18/564852.html&amp;t=%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E5%8D%81%E4%B8%83%EF%BC%89%E2%80%94%E2%80%94Command%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F%20-%20KiddLee%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD&amp;java=1&amp;security=54b54679&amp;sc_random=0.7078293980157213&amp;sc_snum=1&amp;p=0"></A></SPAN>
<NOSCRIPT>&lt;a href="http://www.statcounter.com/" target="_blank"&gt;&lt;img  
src="http://c19.statcounter.com/counter.php?sc_project=2035479&amp;java=0&amp;security=54b54679&amp;invisible=0" 
alt="web stats script" border="0"&gt;&lt;/a&gt; </NOSCRIPT><!-- End of StatCounter Code -->
<DIV id="profile_block">昵称：<A 
href="http://home.cnblogs.com/u/kid-li/">KiddLee</A><BR>园龄：<A title="入园时间：2005-11-07" 
href="http://home.cnblogs.com/u/kid-li/">7年3个月</A><BR>粉丝：<A href="http://home.cnblogs.com/u/kid-li/followers/">45</A><BR>关注：<A 
href="http://home.cnblogs.com/u/kid-li/followees/">0</A>
<DIV id="p_b_follow"><A onclick="cnblogs.UserManager.FollowBlogger('ae46360b-63cf-dd11-9e4d-001cf0cd104b')" 
href="javascript:void(0);">+加关注</A></DIV></DIV></DIV></DIV>
<DIV id="calendar"></DIV>
<DIV id="leftcontentcontainer">
<DIV id="blog-sidecolumn">
<DIV class="mySearch">
<H3 class="catListTitle">Search</H3></DIV><!--
<div class="catListLink">
<h3 class ="catListTitle">常用链接</h3>
<ul>

		<li><a id="ctl01_rptMainLinks_lnkLinkItem_0" href="http://www.cnblogs.com/kid-li/MyPosts.html">我的随笔</a></li>
	
		<li><a id="ctl01_rptMainLinks_lnkLinkItem_1" href="http://www.cnblogs.com/kid-li/MyComments.html">我的评论</a></li>
	
		<li><a id="ctl01_rptMainLinks_lnkLinkItem_2" title="我发表过评论的随笔" href="http://www.cnblogs.com/kid-li/OtherPosts.html">我的参与</a></li>
	
		<li><a id="ctl01_rptMainLinks_lnkLinkItem_3" href="http://www.cnblogs.com/kid-li/RecentComments.html">最新评论</a></li>
	
		<li><a id="ctl01_rptMainLinks_lnkLinkItem_4" href="http://www.cnblogs.com/kid-li/tag/">我的标签</a></li>
	
<li><a id="itemListLink" onclick="this.blur();WarpClass('itemListLink', 'itemListLin_con');return false;" href="#">更多链接</a></li>
</ul>
<div id="itemListLin_con" style="display:none;">
<ul>

</ul>
</div>
</div>
-->
<DIV class="catListTag">
<H3 class="catListTitle">My Tags</H3>
<UL>
  <LI><A 
  href="http://www.cnblogs.com/kid-li/tag/Spring.Net/">Spring.Net</A>(2)</LI>
  <LI><A 
  href="http://www.cnblogs.com/kid-li/tag/%E5%AD%98%E5%82%A8/">存储</A>(1)</LI>
  <LI><A href="http://www.cnblogs.com/kid-li/tag/Image/">Image</A>(1)</LI>
  <LI><A href="http://www.cnblogs.com/kid-li/tag/IoC/">IoC</A>(1)</LI></UL></DIV>
<DIV class="catListPostCategory">
<H3 class="catListTitle">Post Categories<SPAN style="font-size: 11px; font-weight: normal;">(80)</SPAN></H3>
<UL>
  <LI><A id="ctl03_CatList_LinkList_0_Link_0" href="http://www.cnblogs.com/kid-li/category/77076.html">CMMI(1)</A> 
  </LI>
  <LI><A id="ctl03_CatList_LinkList_0_Link_1" href="http://www.cnblogs.com/kid-li/category/45134.html">CodeMake(2)</A> 
  </LI>
  <LI><A id="ctl03_CatList_LinkList_0_Link_2" href="http://www.cnblogs.com/kid-li/category/39641.html">DataBase(4)</A> 
  </LI>
  <LI><A id="ctl03_CatList_LinkList_0_Link_3" href="http://www.cnblogs.com/kid-li/category/39642.html">DotNet(5)</A> 
  </LI>
  <LI><A id="ctl03_CatList_LinkList_0_Link_4" href="http://www.cnblogs.com/kid-li/category/45693.html">EnterpriseLibraryStudy(1)</A> 
  </LI>
  <LI><A id="ctl03_CatList_LinkList_0_Link_5" href="http://www.cnblogs.com/kid-li/category/49153.html">GIS学习探索(1)</A> 
  </LI>
  <LI><A id="ctl03_CatList_LinkList_0_Link_6" href="http://www.cnblogs.com/kid-li/category/65428.html">IOC&amp;AOP(3)</A> 
  </LI>
  <LI><A id="ctl03_CatList_LinkList_0_Link_7" href="http://www.cnblogs.com/kid-li/category/49493.html">J2ME入门学习(2)</A> 
  </LI>
  <LI><A id="ctl03_CatList_LinkList_0_Link_8" href="http://www.cnblogs.com/kid-li/category/103751.html">OOA&amp;D学习与探索系列(8)</A> 
  </LI>
  <LI><A id="ctl03_CatList_LinkList_0_Link_9" href="http://www.cnblogs.com/kid-li/category/65429.html">Remoting(1)</A> 
  </LI>
  <LI><A id="ctl03_CatList_LinkList_0_Link_10" href="http://www.cnblogs.com/kid-li/category/39691.html">System(1)</A> 
  </LI>
  <LI><A id="ctl03_CatList_LinkList_0_Link_11" href="http://www.cnblogs.com/kid-li/category/45604.html">UML(1)</A> 
  </LI>
  <LI><A id="ctl03_CatList_LinkList_0_Link_12" href="http://www.cnblogs.com/kid-li/category/77699.html">VS2005(3)</A> 
  </LI>
  <LI><A id="ctl03_CatList_LinkList_0_Link_13" href="http://www.cnblogs.com/kid-li/category/75489.html">架构设计(6)</A> 
  </LI>
  <LI><A id="ctl03_CatList_LinkList_0_Link_14" href="http://www.cnblogs.com/kid-li/category/45284.html">每日所见记录(22)</A> 
  </LI>
  <LI><A id="ctl03_CatList_LinkList_0_Link_15" href="http://www.cnblogs.com/kid-li/category/44668.html">设计模式(18)</A> 
  </LI>
  <LI><A id="ctl03_CatList_LinkList_0_Link_16" href="http://www.cnblogs.com/kid-li/category/44705.html">杂项(1)</A> 
  </LI></UL></DIV>
<DIV class="catListPostArchive">
<H3 class="catListTitle">Post Archives<SPAN style="font-size: 11px; font-weight: normal;">(82)</SPAN></H3>
<UL>
  <LI><A id="ctl03_CatList_LinkList_1_Link_0" href="http://www.cnblogs.com/kid-li/archive/2008/07.html">2008/7 
  (1)</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_1_Link_1" href="http://www.cnblogs.com/kid-li/archive/2008/06.html">2008/6 
  (1)</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_1_Link_2" href="http://www.cnblogs.com/kid-li/archive/2008/04.html">2008/4 
  (2)</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_1_Link_3" href="http://www.cnblogs.com/kid-li/archive/2008/03.html">2008/3 
  (1)</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_1_Link_4" href="http://www.cnblogs.com/kid-li/archive/2007/12.html">2007/12 
  (1)</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_1_Link_5" href="http://www.cnblogs.com/kid-li/archive/2007/10.html">2007/10 
  (2)</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_1_Link_6" href="http://www.cnblogs.com/kid-li/archive/2007/09.html">2007/9 
  (2)</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_1_Link_7" href="http://www.cnblogs.com/kid-li/archive/2007/08.html">2007/8 
  (3)</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_1_Link_8" href="http://www.cnblogs.com/kid-li/archive/2007/07.html">2007/7 
  (3)</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_1_Link_9" href="http://www.cnblogs.com/kid-li/archive/2007/06.html">2007/6 
  (1)</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_1_Link_10" href="http://www.cnblogs.com/kid-li/archive/2007/04.html">2007/4 
  (1)</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_1_Link_11" href="http://www.cnblogs.com/kid-li/archive/2007/03.html">2007/3 
  (2)</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_1_Link_12" href="http://www.cnblogs.com/kid-li/archive/2007/02.html">2007/2 
  (2)</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_1_Link_13" href="http://www.cnblogs.com/kid-li/archive/2007/01.html">2007/1 
  (1)</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_1_Link_14" href="http://www.cnblogs.com/kid-li/archive/2006/12.html">2006/12 
  (3)</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_1_Link_15" href="http://www.cnblogs.com/kid-li/archive/2006/11.html">2006/11 
  (7)</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_1_Link_16" href="http://www.cnblogs.com/kid-li/archive/2006/10.html">2006/10 
  (5)</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_1_Link_17" href="http://www.cnblogs.com/kid-li/archive/2006/09.html">2006/9 
  (1)</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_1_Link_18" href="http://www.cnblogs.com/kid-li/archive/2006/07.html">2006/7 
  (4)</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_1_Link_19" href="http://www.cnblogs.com/kid-li/archive/2006/06.html">2006/6 
  (3)</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_1_Link_20" href="http://www.cnblogs.com/kid-li/archive/2006/05.html">2006/5 
  (5)</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_1_Link_21" href="http://www.cnblogs.com/kid-li/archive/2006/04.html">2006/4 
  (2)</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_1_Link_22" href="http://www.cnblogs.com/kid-li/archive/2006/03.html">2006/3 
  (1)</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_1_Link_23" href="http://www.cnblogs.com/kid-li/archive/2006/02.html">2006/2 
  (4)</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_1_Link_24" href="http://www.cnblogs.com/kid-li/archive/2006/01.html">2006/1 
  (10)</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_1_Link_25" href="http://www.cnblogs.com/kid-li/archive/2005/12.html">2005/12 
  (8)</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_1_Link_26" href="http://www.cnblogs.com/kid-li/archive/2005/11.html">2005/11 
  (6)</A> </LI></UL></DIV>
<DIV class="catList">
<H3 class="catListTitle">bloger</H3>
<UL>
  <LI><A id="ctl03_CatList_LinkList_2_Link_0" href="http://anchky.cnblogs.com/" 
  rel="nofollow">Anchky</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_2_Link_1" href="http://bear-study-hard.cnblogs.com/" 
  rel="nofollow">bear-study-hard</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_2_Link_2" href="http://blog.163.com/yanpingwang2001@126/" 
  rel="nofollow">ping</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_2_Link_3" href="http://sunmoonfire.cnblogs.com/" 
  rel="nofollow">sunmoonfire</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_2_Link_4" href="http://terrylee.cnblogs.com/" 
  rel="nofollow">terrylee</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_2_Link_5" href="http://blog.tianya.cn/blogger/view_blog.asp?BlogName=fan_er" 
  rel="nofollow">安莉</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_2_Link_6" href="http://crysta10203.blog.sohu.com/" 
  rel="nofollow">大姐大Blog</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_2_Link_7" href="http://herohuo.cnblogs.com/" 
  rel="nofollow">霍春刚</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_2_Link_8" href="http://luking.cnblogs.com/" 
  rel="nofollow">鲁宝春</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_2_Link_9" href="http://nanshouyong326.cnblogs.com/" 
  rel="nofollow">南守拥的blog</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_2_Link_10" href="http://spaces.msn.com/wly0000/" 
  rel="nofollow">吴丽影</A> </LI>
  <LI><A id="ctl03_CatList_LinkList_2_Link_11" href="http://spaces.msn.com/u2ulater/" 
  rel="nofollow">郑义</A> </LI></UL></DIV>
<DIV class="catList用MS.NET开发三层结构应用程序">
<H3 class="catListTitle">三层结构</H3>
<UL>
  <LI><A id="ctl03_CatList_LinkList_3_Link_0" href="http://tech.ccidnet.com/art/1135/20031128/73718_1.html" 
  rel="nofollow">数据层组件设计及其数据传递的实现简介</A> </LI>
  <LI class="c_b_p_link_desc">数据层组件设计及其数据传递的实现简介</LI>
  <LI><A id="ctl03_CatList_LinkList_3_Link_1" href="http://industry.ccidnet.com/art/294/20030526/47418_1.html" 
  rel="nofollow">用MS.NET开发三层结构应用程序</A> <A id="ctl03_CatList_LinkList_3_RssLink_1" 
  onclick="return open_link('http://industry.ccidnet.com/art/294/20030526/47418_1.html');" 
  href="#">(rss)</A></LI>
  <LI class="c_b_p_link_desc">用MS.NET开发三层结构应用程序</LI></UL></DIV><!--
<div class="catListBlogRank">
<h3 class="catListTitle">积分与排名</h3>
<ul>
	<li class="liScore">
		积分 -	191537
	<li class="liRank">
		排名 -	485
	</li>
</ul>
</div>
-->
<DIV class="catListComment">
<H3 class="catListTitle">Recent Comments<A id="_846d63_RSSHyperlink1" href="http://www.cnblogs.com/kid-li/CommentsRSS.aspx"><IMG 
alt="" src="/images/xml.gif"></A></H3>
<DIV id="RecentCommentsBlock">
<UL>
  <LI class="recent_comment_title"><A href="http://www.cnblogs.com/kid-li/archive/2006/11/29/577045.html#2580560">1. 
  Re:C#泛型编程</A></LI><LI class="recent_comment_body">很好，很好，很详细</LI>
  <LI class="recent_comment_author">--淡淡的余香</LI>
  <LI class="recent_comment_title"><A href="http://www.cnblogs.com/kid-li/archive/2006/11/29/577045.html#2459089">2. 
  Re:C#泛型编程</A></LI><LI class="recent_comment_body">解析得很好哈，学习了！</LI>
  <LI class="recent_comment_author">--acause</LI>
  <LI class="recent_comment_title"><A href="http://www.cnblogs.com/kid-li/archive/2006/05/18/403559.html#2454927">3. 
  Re:设计模式学习笔记（六）——Prototype原型模式</A></LI><LI class="recent_comment_body">感觉用ｂｕｉｌｄｅｒ，但又不太像</LI>
  <LI class="recent_comment_author">--nickycookie</LI>
  <LI class="recent_comment_title"><A href="http://www.cnblogs.com/kid-li/archive/2006/11/29/577045.html#2409335">4. 
  Re:C#泛型编程</A></LI><LI class="recent_comment_body">很好，学习了。</LI>
  <LI class="recent_comment_author">--零距离</LI>
  <LI class="recent_comment_title"><A href="http://www.cnblogs.com/kid-li/archive/2006/07/27/461272.html#2393986">5. 
  Re:小议foreach</A></LI><LI class="recent_comment_body">今天刚好老师讲了这个，有点迷糊。。。</LI>
  <LI class="recent_comment_author">--依旧寒风</LI></UL></DIV></DIV>
<H3 class="catListTitle">推荐排行榜</H3>
<DIV class="RecentComment">
<DIV id="TopDiggPostsBlock">
<UL>
  <LI><A href="http://www.cnblogs.com/kid-li/archive/2006/11/29/577045.html">1. 
  C#泛型编程(26)</A></LI>
  <LI><A href="http://www.cnblogs.com/kid-li/archive/2006/03/29/361899.html">2. 
  设计模式学习笔记（一）——面向对象设计模式与原则(5)</A></LI>
  <LI><A href="http://www.cnblogs.com/kid-li/archive/2006/06/26/435966.html">3. 
  设计模式学习笔记（十）——Decorator装饰模式(4)</A></LI>
  <LI><A href="http://www.cnblogs.com/kid-li/archive/2006/10/18/532192.html">4. 
  设计模式学习笔记（十三）——Proxy代理模式(3)</A></LI>
  <LI><A href="http://www.cnblogs.com/kid-li/archive/2006/07/10/446904.html">5. 
  设计模式学习笔记（十一）——Facade外观模式 (3)</A></LI></UL></DIV></DIV></DIV></DIV></DIV><!--end: sideBarMain --></DIV><!--end: sideBar 侧边栏容器 -->
<DIV class="clear"></DIV></DIV><!--end: main -->
<DIV class="clear"></DIV>
<DIV id="footer"><!--done-->Copyright ©2013 KiddLee	</DIV><!--end: footer -->
</DIV><!--end: home 自定义的最大容器 -->
<SCRIPT type="text/javascript" src="http://common.cnblogs.com/script/google-analytics.js"></SCRIPT>
</BODY></HTML>
